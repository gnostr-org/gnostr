{% extends "base.html" %}

{% block content %}
    <div class="table-responsive">
    <table class="repositories">
        <thead>
        <tr>
            <th>Name</th>
            <th>Description</th>
            <th>Owner</th>
            <th>Idle</th>
        </tr>
        </thead>

        <tbody>
        {%- for (path, repositories) in repositories %}
            {%- if let Some(path) = path %}
            <tr><td class="repo-section" colspan="4">{{ path }}</td></tr>
            {%- endif -%}

            {%- for repository in repositories %}
            {% set repository = repository.get() %}
            <tr class="{% if path.is_some() %}has-parent{% endif %}">
                <td>
                    <a href="/{% if let Some(path) = path %}{{ path }}/{% endif %}{{ repository.name }}">
                        {{- repository.name -}}
                    </a>
                </td>
                <td>
                    <a href="/{% if let Some(path) = path %}{{ path }}/{% endif %}{{ repository.name }}">
                        {%- if let Some(description) = repository.description.as_ref() -%}
                            {{- description -}}
                        {%- else -%}
                            Unnamed repository; edit this file 'description' to name the repository.
                        {%- endif -%}
                    </a>
                </td>
                <td>
                    <a href="/{% if let Some(path) = path %}{{ path }}/{% endif %}{{ repository.name }}">
                        {%- if let Some(owner) = repository.owner.as_ref() -%}
                            {{- owner -}}
                        {%- endif -%}
                    </a>
                </td>
                <td>
                    <a href="/{% if let Some(path) = path %}{{ path }}/{% endif %}{{ repository.name }}">
                        <time datetime="{{ repository.last_modified|format_time }}" title="{{ repository.last_modified|format_time }}">
                            {{- repository.last_modified|timeago -}}
                        </time>
                    </a>
                </td>
            </tr>
            {%- endfor -%}
        {%- endfor %}
        </tbody>
    </table>
    </div>
{% endblock %}

{% block scripts %}
<script defer src="/js/bip32@2.0.6.js"></script>
<script defer src="/js/bip39@3.0.4.js"></script>
<script defer src="/js/bitcoinjs-lib.js"></script>
<script defer src="/js/browserify-cipher@1.0.1.js"></script>
<script defer src="/js/buffer@6.0.3.js"></script>
<script defer src="/js/contacts.js"></script>
<script defer src="/js/core.js"></script>
<script defer src="/js/db.js"></script>
<script defer src="/js/event.js"></script>
<script defer src="/js/lib.js"></script>
<script defer src="/js/main.js"></script>
<script defer src="/js/mempool.js"></script>
<script defer src="/js/model.js"></script>
<script defer src="/js/noble-secp256k1@1.2.14.js"></script>
<script defer src="/js/nostr.js"></script>
<script defer src="/js/util.js"></script>
<script defer src="/js/ui/dm.js"></script>
<script defer src="/js/ui/fmt.js"></script>
<script defer src="/js/ui/profile.js"></script>
<script defer src="/js/ui/render.js"></script>
<script defer src="/js/ui/safe-html.js"></script>
<script defer src="/js/ui/settings.js"></script>
<script defer src="/js/ui/state.js"></script>
<script defer src="/js/ui/util.js"></script>
{% endblock %}
